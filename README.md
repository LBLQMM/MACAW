# Macaw

Macaw (**m**olecular **a**utoen**c**oding **a**uto-**w**orkaround) is a cheminformatic tool that featurizes molecules by mapping them onto a low-dimensional, continuous numeric space. Their coordinates are molecular features that can be used as inputs in mathematical and machine-learning models.

Macaw features can be used as a drop-in replacement for conventional molecular descriptors. Macaw features are fast and easy to compute, variable selection is not needed, and they may enable more accuracte predictive models than conventional molecular descriptors.

The Macaw package also contains original algorithms to generate molecular libraries and to evolve molecular libraries *in silico* to satisfy a desired property specification (inverse design problem).

Details about the different algorithms can be read in the [Macaw publication](https://github.com/LBLQMM/macaw).


## Installation

1. Macaw requires rdkit to run. Instructions to install rdkit using conda can be found [here](https://www.rdkit.org/docs/Install.html).

2. Run the following command to install Macaw:

```bash
pip install macaw
```

## Usage

The following illustrates some of the main commands in Macaw. Detailed use examples with real datasets are available as Jupyter Notebooks in the [Macaw repository](https://github.com/LBLQMM/macaw).


### Molecule embedding

Given a list of molecules represented as SMILES strings (`smiles`), their Macaw features (`X`) can be obtained as follows:

```python
from macaw import *

mcw = Macaw(smiles)

X = mcw.transform()
```

Any new list of molecules (`newsmiles`) can be embedded using an existing Macaw object:

```python
X_new = mcw.transform(newsmiles)
```

The embedder has a variety of parameters that can be tuned to improve results. These include the dimensionality of the embedding (`edim`), the number of landmarks used (`Nlndmk`), the type of molecular fingeprint (`fptype`) and similarity metric (`metric`), etc. Property values (`Y_vals`) can also be provided to the argument `Y`. The arguments are described in the function help.

```python
mcw = Macaw(smiles, Nldnmk=60, fptype="rdk5", metric="Sokal", edim=13, Y=Y_vals)
```

The function `Macaw_optimus` automatically explores a variety of fingeprint type (`fptype`) and similarity metric (`metric`) combinations and returns a recommended embedder:

```python
mcw = Macaw_optimus(smiles, y,=Y_vals, verbose=True)
```

### Molecule generation

Given an input dataset of molecules in SELFIES format, Macaw's `library_maker` function can generate a library of molecules around it. The maximum number of molecules to generate is specified with the `N_gen` parameter, while the spread of the distribution can be controlled with the `noise_sd_factor` argument. Additional parameters are explained in the function help.


```python
smiles_lib = library_maker(smiles, N_gen=50000, noise_sd_factor=0.3)
```

### Molecule recommendation (inverse design)

Given a property of interest, a model `f` can be trained to predict the property values of different molecules. The model `f` is trained using as inputs the features generated by a Macaw embedder `mcw`.

Then, we can evolve and recommend molecules to satisfy a desired property specification value (`spec_val`) using the function `library_evolver`. It takes as input the number of molecules ro recommend (`N_hits`), the number of evolution rounds (`N_rounds`), among other optional arguments described in the function's help.

```python
recommended_smiles = library_evolver(smiles, mcw, model=f, spec=spec_val, N_hits=10, N_rounds=8)
```

## License
[MIT](https://choosealicense.com/licenses/mit/)